var calculator={ini:function(a){this.storage=window[a.storage],("undefined"==typeof a.max||a.max>15)&&(a.max=15),"undefined"!=typeof a.selector?($.each(a.selector,function(a,t){calculator.selector[a]=$(t)}),$.each(a.options,function(a,t){calculator.options[a]=t}),this.options.maxLength=Math.min(Math.round($("#input-container").width()/18-1),a.max),this.first="0",this.second="",this.op="","rad"==calculator.storage.radDeg?this.rad():this.deg(),1!=this.options.resume?this.screen.clear():("undefined"==typeof localStorage.first&&(localStorage.first="0"),"undefined"==typeof localStorage.second&&(localStorage.second=""),"undefined"==typeof localStorage.lastSecond&&(localStorage.lastSecond=""),"undefined"==typeof localStorage.op&&(localStorage.op=""),this.screen.resume()),"0"!=calculator.storage.m&&$("#m-status").text("m")):console.error("bad or missing screen selector")},selector:{},options:{},lastSecond:"0",numberClicked:function(a){1==calculator.clear&&calculator.screen.clear();var t="0"==calculator.screen.get()&&0==a&&-1==calculator.selector.screen.text().indexOf(".");return""==calculator.op&&1!=t?calculator.first.replace(/-/g,"").replace(/\./g,"").length<calculator.options.maxLength&&(this.first=String(-1!=this.first.indexOf(".")?this.first.split(".")[0]+"."+this.first.split(".")[1]+a:parseInt(this.first+""+a)),this.screen.set(this.first,!1),1==this.options.resume&&(calculator.storage.first=this.first)):1!=t&&calculator.second.replace(/-/g,"").replace(/\./g,"").length<calculator.options.maxLength&&(this.second=String(0==this.second.length?a:-1!=this.second.indexOf(".")?this.second.split(".")[0]+"."+this.second.split(".")[1]+a:parseInt(this.second+""+a)),this.screen.set(this.second,!1),1==this.options.resume&&(calculator.storage.second=this.second)),a},screen:{set:function(a){if(a=String(a),-1==a.indexOf("e")){-1!=a.indexOf(".")&&-1==a.indexOf("-0")?a=String(parseInt(a.split(".")[0])+"."+a.split(".")[1]):-1==a.indexOf("-0")&&(a=String(parseInt(a)));var c=""!=a&&void 0!=a&&"undefined"!=a}return-1!=a.indexOf("Infinity")||-1!=a.indexOf("e")||"NaN"==a||a.split(".")[0].replace(/-/,"").length>calculator.options.maxLength||!c?(calculator.screen.clear(),calculator.selector.screen.text("ERROR"),console.error("ERROR"),!1):(a.replace(/-/,"").replace(/\./,"").length<=calculator.options.maxLength&&c?calculator.selector.screen.text(calculator.parse.commas(a)):a.split(".")[0].replace(/-/,"").length<calculator.options.maxLength&&c&&calculator.selector.screen.text(calculator.parse.commas(math.round(parseFloat(a),calculator.options.maxLength-a.split(".")[0].length))),calculator.selector.screen.text().replace(/,/g,""))},get:function(){return calculator.selector.screen.text().replace(/,/g,"")},length:function(){return this.get().replace(/\./g,"").replace(/-/g,"").length},clear:function(){""!=calculator.second&&(calculator.lastSecond=calculator.second),calculator.clear=!1,calculator.storage.Clear="false",calculator.first="0",calculator.second="",calculator.selector.screen.text(""),calculator.animate.op(),calculator.op="",overall="",calculator.screen.set(0),1==calculator.options.resume&&(calculator.storage.lastSecond=calculator.lastSecond,calculator.storage.first="0",calculator.storage.second="",calculator.storage.op="",calculator.storage.Clear="false")},resume:function(){calculator.lastSecond=calculator.storage.lastSecond,calculator.clear="true"==calculator.storage.Clear,calculator.first=calculator.storage.first,calculator.second=calculator.storage.second,calculator.op=calculator.storage.op,overall="",""!=calculator.storage.op&&"true"!=calculator.storage.Clear&&calculator.animate.op(calculator.op),calculator.screen.set(""!=calculator.storage.second?calculator.storage.second:calculator.storage.first)}},operator:function(a){return void 0==a&&(a=""),""!=calculator.op?(calculator.calculate(!1,!1),calculator.clear=!1,calculator.storage.Clear="false",calculator.op=a,calculator.animate.op(a)):(calculator.clear=!1,calculator.storage.Clear="false",calculator.op=a,1==this.options.resume&&(calculator.storage.op=a),calculator.animate.op(a)),calculator.op},calculate:function(a,t){new Array;"0"!=this.second&&""!=this.second&&(this.lastSecond=this.second),1==this.options.resume&&(this.storage.lastSecond=this.lastSecond),""!=calculator.second?("plus"==calculator.op?overall=parseFloat(calculator.first)+parseFloat(calculator.second):"subtract"==calculator.op?overall=parseFloat(calculator.first)-parseFloat(calculator.second):"multiply"==calculator.op?overall=parseFloat(calculator.first)*parseFloat(calculator.second):"divide"==calculator.op?overall=parseFloat(calculator.first)/parseFloat(calculator.second):"mod"==calculator.op?overall=parseFloat(calculator.first)%parseFloat(calculator.second):"pow-of-y"==calculator.op?overall=Math.pow(parseFloat(calculator.first),parseFloat(calculator.second)):"square-root-y"==calculator.op&&(overall=this.math.nthroot(parseFloat(calculator.first),parseFloat(calculator.second))),calculator.selector.screen.text(""),setTimeout(calculator.screen.set,100,overall),this.animate.op(),calculator.first=String(overall),calculator.second="",overall="",1==this.options.resume&&(this.storage.first=this.first,this.storage.second=this.second,this.storage.op=this.op),1==a&&(this.clear=!0,calculator.storage.Clear="true")):""!=calculator.lastSecond&&""!=calculator.op&&0!=t&&("plus"==calculator.op?overall=parseFloat(calculator.first)+parseFloat(calculator.lastSecond):"subtract"==calculator.op?overall=parseFloat(calculator.first)-parseFloat(calculator.lastSecond):"multiply"==calculator.op?overall=parseFloat(calculator.first)*parseFloat(calculator.lastSecond):"divide"==calculator.op?overall=parseFloat(calculator.first)/parseFloat(calculator.lastSecond):"mod"==calculator.op?overall=parseFloat(calculator.first)%parseFloat(calculator.lastSecond):"pow-of-y"==calculator.op?overall=Math.pow(parseFloat(calculator.first),parseFloat(calculator.lastSecond)):"square-root-y"==calculator.op&&(overall=this.math.nthroot(parseFloat(calculator.first),parseFloat(calculator.lastSecond))),calculator.selector.screen.text(""),setTimeout(calculator.screen.set,100,overall),this.animate.op(),calculator.first=String(overall),calculator.second="",overall="",1==this.options.resume&&(this.storage.first=this.first,this.storage.second=this.second,this.storage.op=this.op),1==a&&(this.clear=!0,calculator.storage.Clear="true"))},mathFunctions:{pi:function(){return String(Math.PI)},e:function(){return Math.E},pow:function(a,t){return math.pow(a,t)},nthroot:function(a,t){try{var c=t%2==1&&0>a;c&&(a=-a);var e=Math.pow(a,1/t);if(t=Math.pow(e,t),Math.abs(a-t)<1&&a>0==t>0)return c?-e:e}catch(r){}},"in":function(a){return Math.log(a)},log:function(a,t){return math.log(parseFloat(a),t)},sin:function(a){return math.sin(math.unit(a,calculator.storage.radDeg))},cos:function(a){return math.cos(math.unit(a,calculator.storage.radDeg))},tan:function(a){return math.tan(math.unit(a,calculator.storage.radDeg))},sinh:function(a){return math.sinh(math.unit(a,calculator.storage.radDeg))},cosh:function(a){return math.cosh(math.unit(a,calculator.storage.radDeg))},tanh:function(a){return math.tanh(math.unit(a,calculator.storage.radDeg))},asin:function(a){return"rad"==calculator.storage.radDeg?math.asin(a):math.asin(a)*(180/Math.PI)},acos:function(a){return"rad"==calculator.storage.radDeg?math.acos(a):math.acos(a)*(180/Math.PI)},atan:function(a){return"rad"==calculator.storage.radDeg?math.atan(a):math.atan(a)*(180/Math.PI)},asinh:function(a){return Math.asinh(a)},acosh:function(a){return Math.acosh(a)},atanh:function(a){return Math.atanh(a)}},math:function(a,t,c){var e=calculator.mathFunctions[a](parseFloat(t),parseFloat(c));return e!==!1?""==calculator.op?(calculator.first=calculator.screen.set(e),calculator.storage.first=calculator.first):(calculator.second=calculator.screen.set(e),calculator.storage.second=calculator.second):void calculator.screen.get()},event:{sq:function(){var a=calculator.screen.get();return 1==calculator.clear&&calculator.screen.clear(),""==calculator.op?calculator.screen.length()<calculator.options.maxLength&&(calculator.first=String(calculator.mathFunctions.pow(parseFloat(a),2)),calculator.screen.set(calculator.first),calculator.storage.first=calculator.first):calculator.screen.length()<calculator.options.maxLength&&(("."==calculator.second||""==calculator.second)&&(calculator.second="0."),calculator.second=String(calculator.mathFunctions.pow(parseFloat(a),2)),calculator.screen.set(calculator.second),calculator.storage.second=calculator.second),calculator.screen.get()},sqrt:function(){var a=calculator.screen.get();return 1==calculator.clear&&calculator.screen.clear(),""==calculator.op?(calculator.first=String(calculator.mathFunctions.nthroot(parseFloat(a),2)),calculator.screen.set(calculator.first),calculator.storage.first=calculator.first):(calculator.second=String(calculator.mathFunctions.nthroot(parseFloat(a),2)),calculator.screen.set(calculator.second),calculator.storage.second=calculator.second),calculator.screen.get()},addDecimal:function(){return 1==calculator.clear&&calculator.screen.clear(),""==calculator.op?-1==calculator.first.indexOf(".")&&calculator.screen.length()<calculator.options.maxLength&&(calculator.first=calculator.first+".",calculator.screen.set(calculator.first),calculator.storage.first=calculator.first):-1==calculator.second.indexOf(".")&&calculator.screen.length()<calculator.options.maxLength&&(("."==calculator.second||""==calculator.second)&&(calculator.second="0."),calculator.second=calculator.second+".",calculator.screen.set(calculator.second),calculator.storage.second=calculator.second),calculator.screen.get()},posNeg:function(){return""==calculator.op&&(calculator.first=0==calculator.first.length?"-0":-1==calculator.first.indexOf("-")?"-"+calculator.first:calculator.first.replace(/-/g,""),calculator.screen.set(calculator.first),calculator.storage.first=calculator.first),""!=calculator.op&&(calculator.second=0==calculator.second.length?"-0":-1==calculator.second.indexOf("-")?"-"+calculator.second:calculator.second.replace(/-/g,""),calculator.screen.set(calculator.second),calculator.storage.second=calculator.second),calculator.screen.get()},radDeg:function(){return"rad"==calculator.selector.radDeg.text()?calculator.storage.radDeg=calculator.deg():"deg"==calculator.selector.radDeg.text()&&(calculator.storage.radDeg=calculator.rad()),calculator.screen.get()},percentage:function(){return""==calculator.op?(calculator.first=String(.01*calculator.first),calculator.clear=!0,calculator.storage.Clear="true",calculator.screen.set(calculator.first)):(calculator.second=String(.01*calculator.first*calculator.second),calculator.clear=!0,calculator.storage.Clear="true",calculator.screen.set(calculator.second))}},m:{recall:function(){return 0!=parseFloat(calculator.storage.m)&&(""==calculator.op?(calculator.first=calculator.storage.m,calculator.screen.set(calculator.first)):(calculator.second=calculator.storage.m,calculator.screen.set(calculator.second))),calculator.storage.m},clear:function(){return calculator.storage.m=0,$("#m-status").text(""),calculator.storage.m},minus:function(){return calculator.storage.m=parseFloat(calculator.storage.m)-parseFloat(calculator.screen.get()),$("#m-status").text("0"!=calculator.storage.m?"m":""),calculator.storage.m},plus:function(){return calculator.storage.m=parseFloat(calculator.storage.m)+parseFloat(calculator.screen.get()),$("#m-status").text("0"!=calculator.storage.m?"m":""),calculator.storage.m}},parse:{commas:function(a){var t=a.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}},animate:{op:function(a){$(".opp").css({"-webkit-transform":"scale(1)"}),void 0!=calculator.op?($("#"+a).css({"-webkit-transform":"scale(0.90)"}),setTimeout(function(){$("#"+a).css({"-webkit-transform":"scale(0.95)"})},100)):$("#"+a).css({"-webkit-transform":"scale(1)"})}},clipboard:{copy:function(a){var t=$("<input/>");return t.val(a),$("body").append(t),t.select(),document.execCommand("copy"),t.remove(),a},paste:function(){var a=$("<input/>");$("body").append(a),a.select(),document.execCommand("paste");var t=parseFloat(a.val());return isNaN(parseFloat(t))||"0"==String(t)?(calculator.selector.screen.text("ERROR"),calculator.screen.clear()):(calculator.screen.set(t),""==calculator.op?calculator.first=t:calculator.second=t),a.remove(),t}},rad:function(){return this.selector.radDeg.text("rad"),"undefined"!=typeof this.selector.radDegInvert&&this.selector.radDegInvert.text("deg"),"rad"},deg:function(){return this.selector.radDeg.text("deg"),"undefined"!=typeof this.selector.radDegInvert&&this.selector.radDegInvert.text("rad"),"deg"}};$(document).ready(function(){calculator.ini({storage:"localStorage",selector:{screen:"#input",radDeg:"#rad-deg",radDegInvert:"#rad-deg-invert"},options:{resume:!0,log:!0},max:15})});
